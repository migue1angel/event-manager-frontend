<div class="flex flex-column gap-4">
  <div class="flex justify-content-between align-items-center p-3 surface-section shadow-2">
    <h1 class="text-xl font-bold m-0">Gestión de Eventos</h1>
    <div class="flex gap-2">
      <p-button
        [outlined]="vistaActual !== 'creados'"
        [raised]="vistaActual === 'creados'"
        label="Evento creado"
        (onClick)="cambiarVista('creados')"
        class="p-button-sm">
      </p-button>
      <p-button
        [outlined]="vistaActual !== 'registrados'"
        [raised]="vistaActual === 'registrados'"
        label="Agenda"
        (onClick)="cambiarVista('registrados')"
        class="p-button-sm">
      </p-button>
    </div>
  </div>

  <!-- Botón de agregar (solo visible en la vista de eventos creados) -->
  <div *ngIf="vistaActual === 'creados'" class="flex justify-content-end">
    <p-button
      label="Agregar Evento"
      icon="pi pi-plus"
      (onClick)="agregarEvento()"
      styleClass="p-button-success">
    </p-button>
  </div>

  <!-- Lista de eventos -->
  <p-dataView [value]="eventosFiltrados">
    <ng-template pTemplate="header">
      <h2 class="m-0 p-3">
        {{ vistaActual === 'creados' ? 'Lista de eventos creados' : 'Agenda (eventos registrados)' }}
      </h2>
    </ng-template>
    <ng-template pTemplate="list" let-eventos>
      <div class="grid grid-nogutter">
        @for (evento of eventos; track evento.id; let first = $first) {
        <div class="col-12">
          <div class="flex flex-column sm:flex-row sm:align-items-center p-4 gap-3"
              [ngClass]="{ 'border-top-1 surface-border': !first }">
            <div class="md:w-10rem relative bg-secondary">
              <img class="block xl:block mx-auto border-round w-full" [src]="evento.images[0].url"
                  [alt]="evento.name" />
            </div>
            <div class="flex flex-column md:flex-row justify-content-between md:align-items-center flex-1 gap-4">
              <div class="flex flex-column justify-content-between align-items-start gap-2">
                <div>
                  <span class="font-medium text-secondary text-sm">{{ evento.category.name }}</span>
                  <div class="text-lg font-medium text-900 mt-2">{{ evento.name }}</div>
                </div>
                <div class="surface-0 flex align-items-start gap-2 justify-content-center py-1 px-2 max-h-5rem overflow-hidden">
                  <p class="">{{evento.description}}</p>
                </div>
              </div>
              <div class="flex flex-column md:align-items-end gap-5">
                <div class="flex flex-row-reverse md:flex-row gap-2">
                  <p-button icon="pi pi-save" [outlined]="true" />
                  <p-button icon="pi pi-info" class="flex-auto md:flex-initial white-space-nowrap"
                      [routerLink]="'/core/event/public/event-detail/'+evento.id" label="Ver a detalle" />
                </div>
              </div>
            </div>
          </div>
        </div>
        }
      </div>
    </ng-template>
  </p-dataView>
</div>

